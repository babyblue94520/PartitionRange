package com.tt;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

public class CreateSumWithDay {
	private final static String sqlTemplate = "insert BET_WinLoss_Day select UUID() as uuid ,#key as time ,'EGZ' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_EGZ_slot_01_B t left join BET_EGZ_slot_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'EGZ' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_EGZ_poker_01_B t left join BET_EGZ_poker_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'EGZ' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_EGZ_table_01_B t left join BET_EGZ_table_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'EGZ' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_EGZ_lucky_01_B t left join BET_EGZ_lucky_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'EGZ' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_EGZ_slot_03_B t left join BET_EGZ_slot_03_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'EGZ' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_EGZ_race_01_B t left join BET_EGZ_race_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'HOG' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_HOG_live_01_B t left join BET_HOG_live_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'HOG' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_HOG_slot_01_B t left join BET_HOG_slot_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'BSOFT' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_BSOFT_slot_01_B t left join BET_BSOFT_slot_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'BSOFTL' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_BSOFTL_live_01_B t left join BET_BSOFTL_live_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'AB' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_AB_live_01_B t left join BET_AB_live_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'RYL' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_RYL_live_01_B t left join BET_RYL_live_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'IBIGO' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_IBIGO_ball_01_B t left join BET_IBIGO_ball_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'ILOT6' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_ILOT6_ball_01_B t left join BET_ILOT6_ball_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet03 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'IBSB' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_IBSB_ball_01_B t left join BET_IBSB_ball_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet03 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'EBET' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_EBET_live_01_B t left join BET_EBET_live_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'P68' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_P68_slot_01_B t left join BET_P68_slot_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44 union all select UUID() as uuid ,#key as time ,'P68L' as platform ,t.bet21 as game ,t2.dbet03 as level1 ,t2.dbet10 as level2 ,t2.dbet17 as level3 ,t2.dbet24 as level4 ,t2.dbet31 as level5 ,t2.dbet38 as level6 ,t2.dbet44 as level7 ,count(1) as bet_count ,sum(t.bet11) as bet ,sum(t.bet30) as valid_bet ,sum(t.bet13) as winLoss from BET_P68L_live_01_B t left join BET_P68L_live_01_D t2 on t2.dbet01 = t.bet01 where 1 = 1  and t.bet_flag = 0 and t.bet06 > 0 and t.bet05 between #start and #end group by t.bet21,t2.dbet03,t2.dbet10,t2.dbet17,t2.dbet24,t2.dbet31,t2.dbet38,t2.dbet44;";
	private static SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
	
	public static void main(String[] args) throws ParseException{
		Date date = sdf.parse("sdfsaf");
		
//		Calendar start = Calendar.getInstance();
//		Calendar end = Calendar.getInstance();
//		start.setTime(date);
//		end.setTime(date);
//		end.add(Calendar.DATE, 1);
//		int i = 0;
//		
//		while(i++<30){
////		while(end.getTime().getTime()<System.currentTimeMillis()){
//
//			String startStr = String.valueOf(start.getTime().getTime()/1000);
//			String endStr = String.valueOf((end.getTime().getTime()/1000)-1);
//
//			System.out.println(sqlTemplate.replaceAll("#key", startStr)
//					.replaceAll("#start", startStr)
//					.replaceAll("#end", endStr)
//					.replaceAll("group by", "\n group by"));
//			start.add(Calendar.DATE, 1);
//			end.add(Calendar.DATE, 1);
//		}
		
//		String start = String.valueOf(sdf.parse("2017-02-1").getTime()/1000);
//		String end = String.valueOf((sdf.parse("2017-02-2").getTime()/1000)-1);
//		
//	
//		System.out.println(sqlTemplate.replaceAll("#key", start)
//				.replaceAll("#start", start)
//				.replaceAll("#end", end)
//				.replaceAll("group by", "\n group by"));
	}
}
